"$schema": https://json-schema.org/draft/2020-12/schema
"$id": https://7thletter.dev/registry.json
title: Registry File Schema
description: Shape of device registry. All properties are SENSITIVE.
type: object
required:
  - name
  - id
  - jwt
properties:
  name:
    type: string
    description: >
      2-4 word human readable name identifying a device, its synchronization database,
      and the associated database access role. 
      Can be changed if the knowledge of the id is proven through a argon2 hash challenge.
  id:
    type: string
    description: >
      uuidv4 string that uniquely identifies a device and proves its ownership. Only the owner should have
      knowledge of the id, and only if they need to reset its name in case of a jwt compromise. Should be physically
      engraved on the device in an inaccessible place with reasonable physical security.
  jwt:
    type: string
    description: >
      jwt string used to authenticate to synchronization database from both the terminal and the device. 
      Does not expire.
      If compromised, reset the name.
  _jwt_payload:
    type: object
    description: >
      Not included in the actual table. Here to document how jwt_payload should be derived.
      Do not expect this key to exist when pulling from blob storage.
    properties:
      alg:
        type: string
        const: ES256
      sub:
        description: Should be the same as the name
        type: string
      _couchdb.roles:
        description: "An array of a single string: the name"
        type: array
        items:
          type: string
  

